# 云计算复习

## 0 重点

![image-20221029170621212](https://my-picture-repo.obs.cn-east-3.myhuaweicloud.com/my-note-imgs/image-20221029170621212.png)

虚拟化的目标和目的；虚拟化性能与指标之间的关系，不同虚拟化技术之间的对比

硬件级的虚拟化：cpu虚拟化、内存虚拟化、IO虚拟化

三种具体的解决方案：1、基于软件的完全虚拟化；最大的特征：效率比较低。2、基于硬件辅助的虚拟化；插入一个新的特权级。3、改操作系统的半虚拟化，改动现有操作系统。

存储虚拟化的概念....

网络的虚拟化...

有哪些迁移策略，三种策略...

openstack组件间的交互



## 一、云计算概念

### 1、什么是云计算

云计算是一种基于互联网的计算方式，通过这种设备，共享的软硬件资源和信息可以按需求提供给计算机各种终端和其他设备。

### 2、计算模式的演进

#### 2.1、演进过程

- 主机系统与集中计算 => <u>效用计算</u> => 客户机/服务器模式 => 集群计算 => <u>服务计算</u> => 个人计算机与桌面计算 => 分布式计算 => 网格计算 => 软件即服务 =》**云计算**
  - 效用计算：考虑购买主机成本高，将IT资源包装成可以度量的服务提供给用户
  - 服务计算（软件即服务SaaS）：将所有应用程序都作为服务提供，而不是购买软件

- <u>**云计算 是 效用计算 + 服务计算**</u>

  增强版的效用计算（不仅考虑计费，还考虑IT管理）+更广泛的服务计算（不仅是软件，还包括基础设施和平台）

#### 2.2、传统分布式计算系统

1、计算机集群：将多个可信、静态的独立节点连接起来协作完成计算

![image-20221029170637355](https://my-picture-repo.obs.cn-east-3.myhuaweicloud.com/my-note-imgs/image-20221029170637355.png)

2、P2P网络：每个节点既是客户端也是服务端，提供部分系统资源

![image-20221029170649241](https://my-picture-repo.obs.cn-east-3.myhuaweicloud.com/my-note-imgs/image-20221029170649241.png)

3、计算网格：多个异构计算机动态、紧耦合地整合在一起完成计算任务

![image-20221029170705498](https://my-picture-repo.obs.cn-east-3.myhuaweicloud.com/my-note-imgs/image-20221029170705498.png)

#### 2.3、云计算

一种完美的分布式计算解决方案——对网格的优化

1、大量计算节点、同构可控

2、专用内部网络

3、通过互联网对外服务（公有云）

4、全面虚拟化：计算、存储、网络、桌面

5、集中管理：安全、高效

![image-20221029170714621](https://my-picture-repo.obs.cn-east-3.myhuaweicloud.com/my-note-imgs/image-20221029170714621.png)

> 和网格计算的区别：恰好有 vs 专门做

### 3、云计算的发展与推动力

网络带宽的提升、技术成熟度、移动互联网的发展、数据中心的演变、经济因素、大数据的需求

![image-20221029170725405](https://my-picture-repo.obs.cn-east-3.myhuaweicloud.com/my-note-imgs/image-20221029170725405.png)

**持续优化的动力：<u>节能降耗、降低维护成本、提升资产安全、提升信息系统的容灾备份能力</u>**

### 4、云计算的特征与分类

#### 特征

1、超大规模——需求

2、虚拟化——技术

3、按需服务——商业模式

4、通用

5、高可伸缩

6、极其廉价

7、高可靠——要求

#### 云的服务类型

![image-20221029170735943](https://my-picture-repo.obs.cn-east-3.myhuaweicloud.com/my-note-imgs/image-20221029170735943.png)

#### 云计算三元认知论

（相互依托，缺一不可）

1、一种商业模式

2、一种计算范式

3、一种实现方式

#### 开源之于云计算

1、开源促进国家信息技术创新，带动经济发展

2、软件厂商依托开源提升研发能力

3、用户使用开源技术改变信息化路线

4、企业自主开源，引领技术发展路径

### 5、问题

#### 5.1、发展现状

Google Trends 很热、国家十分重视、产业发展十分蓬勃（各种各样的公有云平台）、互联网云化、产业规模持续扩大

#### 5.2、优势

经济性、可扩展性和可伸缩性、虚拟化、高可靠、管理简单、安全

#### 5.3、和新技术间的关系

> 一切皆为大数据，一切皆为大数据

大数据促进了云计算的产生，激发了云计算的潜力；云计算为大数据的收集、存储、加工和应用提供了更好的支持（关系密切而多样）。

#### 5.4、风险与挑战

1、增加了安全漏洞

2、降低了运营管理控制

3、云提供者之间有限的可移植性

4、多地区法规和法律问题

## 二、云计算架构

### 1、计算架构及演化

Service-oriented Architecture 面向服务的体系结构

- 每个程序只做本职工作，将服务暴露出来供其他程序使用
- 多个程序通过一个统一的界面协调工作——控制复杂度，更容易管理

![image-20221029170750242](https://my-picture-repo.obs.cn-east-3.myhuaweicloud.com/my-note-imgs/image-20221029170750242.png)

SOA是关于如何设计一套使用服务的软件系统，使得服务间的互操作性变得可扩展和有效，特点：松耦合，定义并发布接口，基于标准的通信模型。

**云计算是服务计算架构的极致，不仅仅软件作为服务，一切IT资源都是服务**

### 2、概念架构（二维视角）

> 关注云的功能

1、基础设施——云内部，后端

硬件：服务器、存储器、网络交换机等

管理软件：服务的高可用性、可恢复性、数据一致性，应用伸缩性、可预测性，云安全等

2、应用程序——云外部，前端

并发性、协调性、容错性、开放的API格式、开放的数据格式、承载数据密集型计算

![image-20221029170800147](https://my-picture-repo.obs.cn-east-3.myhuaweicloud.com/my-note-imgs/image-20221029170800147.png)

### 3、逻辑架构

#### 云栈

提供的服务多种多样，规模巨大，需要简历规则才能便于管理，即层次架构，**从纵向的方式来构建云计算的整体架构**

**三层模式**

![image-20221029170811837](https://my-picture-repo.obs.cn-east-3.myhuaweicloud.com/my-note-imgs/image-20221029170811837.png)

与云栈分层架构对应的是云计算技术体系结构——如何实现三层服务

**体系结构**

![image-20221029170823066](https://my-picture-repo.obs.cn-east-3.myhuaweicloud.com/my-note-imgs/image-20221029170823066.png)

#### 云体

云栈是从纵向角度看云计算的整体架构，而云体则主要是从横向角度看其架构模式

类比传统操作系统横切面：运行时环境 + 应用本身（程序+数据）

![image-20221029170835457](https://my-picture-repo.obs.cn-east-3.myhuaweicloud.com/my-note-imgs/image-20221029170835457.png)

### 4、物理架构

#### 物理云体云数据中心

数据中心是数据集中存储、计算、交换的中心

传统数据中心的问题：过多的机器、机器利用率过低、应用迁移困难、存储需求增长太快

软件定义的数据中心

![image-20221029170845555](https://my-picture-repo.obs.cn-east-3.myhuaweicloud.com/my-note-imgs/image-20221029170845555.png)

#### 物理云栈OpenStack

OpenStack是一个管理云计算中计算、存储和网络，甚至是应用的通用平台。

本质上 OpenStack 通过抽象和一个通用的API接口控制不同厂商提供的硬件资源和软件资源，是对计算机系统的更高层次的抽象

## 三、云数据中心

### 1、特征

高设备利用率

绿色节能

高可用性

自动化管理

### 2、网络部署

> 传统树结构：建造方便简单，但是不便于拓展和升级，任意一个核心交换机故障导致上千台服务器失效

#### **<u>改进树</u>**

##### FatTree

![image-20221029170856783](https://my-picture-repo.obs.cn-east-3.myhuaweicloud.com/my-note-imgs/image-20221029170856783.png)

特点：

- K叉树，K个Pod（集装器），每个Pod有K个交换机，其中$\frac{K}{2}$个接入交换机，$\frac{K}{2}$个汇聚交换机。
- Pod中每个交换机有K个接口，$\frac{K}{2}$个接主机，$\frac{K}{2}$个接汇聚，$\frac{K}{2}$个接接入，$\frac{K}{2}$个接核心

##### VL2

可扩展且很灵活的网络架构，用多个小规模、低成本的单元，构建复杂、大规模的网络

![image-20221029170907922](https://my-picture-repo.obs.cn-east-3.myhuaweicloud.com/my-note-imgs/image-20221029170907922.png)

若干服务器连接到机架（接入）交换机

每台接入交换机与两台汇聚交换机连接

每台汇聚交换机与所有核心交换机连接

#### 递归层次

解决可扩展性的较好选择：每一个高层的网络拓扑，由多个低层的递归单元按照递归规律相互连接构成，同时也是更高级网络的一个递归单元

1、DCell

2、FiConn

3、BCube

4、MDCube

#### 光交换网络

Helios：混合电/光结构网络

![image-20221029170919481](https://my-picture-repo.obs.cn-east-3.myhuaweicloud.com/my-note-imgs/image-20221029170919481.png)

- 服务器连接接入交换机
- 接入交换机连接电交换和光交换网络

更高的传输效率、更灵活的拓扑结构、更低的制冷成本

#### 无线数据中心网络

![image-20221029170931644](https://my-picture-repo.obs.cn-east-3.myhuaweicloud.com/my-note-imgs/image-20221029170931644.png)

Flyways：在过热的交换机间添加无线链路；使用贪心算法将最大流量链路分摊到其他可行路径

#### 软件定义网络

![image-20221029170941841](https://my-picture-repo.obs.cn-east-3.myhuaweicloud.com/my-note-imgs/image-20221029170941841.png)

Openflow：第一个针对SDN实现的标准接口

![image-20221029170953404](https://my-picture-repo.obs.cn-east-3.myhuaweicloud.com/my-note-imgs/image-20221029170953404.png)

### 3、绿色节能技术

#### 配电系统节能

1、高压直流配电技术：高压直流到服务器；高压直流到机架

2、市电直供配电技术：服务器自带电池，支撑到备用电源启动；额外充电蓄电池作为备份电源

#### 空调系统节能

高温回风空调系统、低能耗加湿系统、自然冷空调系统、水自然冷系统

#### 集装箱数据中心节能技术

将高密度设备装入固定尺寸的集装箱中，称为数据中心的标准构建模块

缩短送风距离、提高冷通道温度、冷热通道完全隔离、Free Cooling功能

#### 管理系统节能策略和算法

#### 新能源应用

新能效+新能源；开发利用可再生能源，太阳能、生物质能、风能等

### 4、自动化管理

资源的自动化调度和对业务的灵活响应，即需要单个业务能自治管理，也需要一个负责全局控制和协调的中心，对业务和资源进行统一监控、管理和调度。

#### 五个特征

全面的可视性、自动的控制执行、多层次的无缝集成、综合与实时的报告、全生命周期支持

#### 三个阶段

IT服务操作 =》 IT服务管理 =》数据中心自动化

#### 四个条件

管理系统、定义过程、认知非自动化过程的成本、内部流程资源

### 5、容灾备份

容灾备份是通过在异地建立和维护一个备份存储系统。利用地理上的分离来保证系统和数据对灾难性事件的抵御能力

数据级容灾和应用级容灾：保证数据的完整性、可靠性和安全性；保证可以提供不间断的应用服务

#### 关键技术

核心：复制数据

远程镜像技术

快照技术

基于IP的SAN的远程数据容灾备份技术

数据库恢复技术

## 四、虚拟化技术

### 1、基本概念

> 虚拟化是云计算的核心技术，但不是其专用技术

虚拟化的本质就是通过添加一个**虚拟化层**将原先的物理设备进行逻辑虚拟化，转化成一个文件夹或文件，实现软硬件的解耦

核心思想是利用软件或固件管理程序构成虚拟化层，把物理资源映射为虚拟资源。在虚拟资源上可以安装和部署多个虚拟机，实现多用户共享物理资源。

### 2、虚拟化层级

![image-20221029171016011](https://my-picture-repo.obs.cn-east-3.myhuaweicloud.com/my-note-imgs/image-20221029171016011.png)

#### 2.1、硬件级虚拟化

三个要求：

1、为程序提供与原始硬件机基本一致的环境

2、运行在该虚拟硬件环境中的程序性能损失应该比较低

3、系统资源应该处于VMM的完全控制之中

![image-20221029171029404](https://my-picture-repo.obs.cn-east-3.myhuaweicloud.com/my-note-imgs/image-20221029171029404.png)

优势：封装性、多实例、隔离、硬件无关性、特权功能

虚拟化的硬件对象：CPU、内存、I/O设备

1、基于软件的完全虚拟化

2、基于硬件辅助的虚拟化

3、改操作系统的类虚拟化

#### 2.2、操作系统级虚拟化

> 虚拟执行环境/虚拟专用系统 /容器

需要主机操作系统，在主机操作系统中插入一个虚拟化层，在同一个操作系统内核内，运行多个虚拟机

![image-20221029171040830](https://my-picture-repo.obs.cn-east-3.myhuaweicloud.com/my-note-imgs/image-20221029171040830.png)

#### 2.3、不同层级虚拟化技术对比

![image-20221029171049488](https://my-picture-repo.obs.cn-east-3.myhuaweicloud.com/my-note-imgs/image-20221029171049488.png)

### 3、云数据中心的虚拟化

#### 为什么要虚拟化

1、提升资源共享与复用的效率，降低成本

2、提升可扩展性，提升存储资源使用效率

3、随着虚拟机的迁移一起迁移

#### 服务器虚拟化

将一个或多个物理服务器虚拟成多个逻辑上的服务器

![image-20221029171103347](https://my-picture-repo.obs.cn-east-3.myhuaweicloud.com/my-note-imgs/image-20221029171103347.png)

系统性能增强、安全性增强；通用性不高

#### 存储虚拟化

把分布的异构存储设备统一为一个或几个大的存储池

基于主机的存储虚拟化、基于存储设备的存储虚拟化、基于网络的存储虚拟化

#### 网络虚拟化

在底层物理网络和网络用户之间增加一个抽象层

核心层网络虚拟化、接入层网络虚拟化、虚拟机网络虚拟化

### 4、虚拟机迁移

#### 需求

负载平衡；物理服务器定期升级的需要

#### 分类

P2V、V2V、V2P

#### 步骤

预迁移=》预定资源=》预复制=》启动=》提交=》停机复制

#### 内容

> 重点：实时迁移

内存迁移（最困难）：Stop-and-copy、Stop-and-copy和pull阶段结合、push和stop-and-copy阶段结合

网络迁移

存储设备迁移

## 五、OpenStack

### 1、介绍

OpenStack是开源云计算平台（云操作系统），可控制整个数据中心的大型计算，存储和网络资源池，用户可以通过Web界面、命令行或API接口控制、配置资源

**特点：**

1、自身不提供虚拟化技术

2、调用多种技术实现多资源池管理

3、对外提供统一管理接口

4、环境隔离，资源复用

5、降低隔离损耗，提升运行效率

6、提供高级虚拟化特性

![image-20221029171115782](https://my-picture-repo.obs.cn-east-3.myhuaweicloud.com/my-note-imgs/image-20221029171115782.png)

**<u>云操作系统</u>**：架构于服务器、存储、网络等基础硬件资源和单机操作系统、中间件、数据库等基础软件之上，管理海量的基础硬件、软件资源的云平台综合管理系统

**<u>设计理念</u>**：开放、灵活、可扩展

![image-20221029171125190](https://my-picture-repo.obs.cn-east-3.myhuaweicloud.com/my-note-imgs/image-20221029171125190.png)

在云计算中的重要地位: 赋能安全、灵活、易扩展的全面自动化数据中心

#### 架构设计

概念模型设计：各个功能模块的功能及其之间的交互

逻辑模型设计：控制节点中封装了大量的Openstack的服务

物理模型设计：分析需求、考虑需求增长情况、持续跟踪每一个服务单元、丢弃和替换服务单元；按需调整

### 2、部署

> 看不懂，略...

### 3、云控制器

Keystone：身份认证和服务目录（所有其他服务需向Keystone注册API端点）

Nova是OpenStack中提供计算资源服务的项目，是OpenStack最核心的项目；负责虚拟机和其他计算资源的生命周期管理

### 4、计算节点

Hypervisor是Nova计算节点的核心，又称VMM

​	按照nova单元管理计算节点，增强计算节点的隔离性和分散性

独立为专门提供容器集群服务的项目：Magnum，提供容器编排引擎（COE）以方便部署和管理容器集群

### 5、存储节点

对象存储 Swift：数据与其副本作为二进制大对象存储在对象存储服务器上

块存储Clinder：对卷的管理

### 6、网络节点

Neutron组件，API服务器运行在云控制器上

核心插件创建和管理网络、端口和子网；服务插件实现高阶网络服务、路由、防火墙等

### 组件

![image-20221029180410295](https://my-picture-repo.obs.cn-east-3.myhuaweicloud.com/my-note-imgs/image-20221029180410295.png)

从虚拟机的创建看组件间的联系

![image-20221029180532176](https://my-picture-repo.obs.cn-east-3.myhuaweicloud.com/my-note-imgs/image-20221029180532176.png)

## 六、分布式计算

### 1、定义

多个通过网络互联的计算机都具有一定的计算能力，他们相互之间传递数据，实现信息共享，协作共同完成一个处理任务

### 2、理论基础

- ACID原则
- CAP理论：一致性、可用性、分区容错性中的两项
- BASE理论：Basically Avaliable（基本可用）、Soft State（软状态）、Eventual Consistency（最终一致性）
- 一致性算法
- 一致性Hash

### 3、类型

分布式存储系统

分布式计算系统

​	1、传统基于消息的系统

​	2、Dataflow系统

​	3、流式计算、图计算、分布式机器学习

分布式资源管理系统

### 4、案例

网格系统

P2P系统

区块链

Spark & Hadoop
